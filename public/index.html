<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>justüîó4u ‚Äî Developer Platform</title>
  <link rel="icon" href="data:," />
  <style>
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);color:#2d3748}
    .header{position:sticky;top:0;z-index:10;background:rgba(255,255,255,.95);backdrop-filter:blur(16px);border-bottom:1px solid rgba(0,0,0,.06)}
    .container{max-width:1200px;margin:0 auto;padding:16px 20px}
    .logo{font-size:2rem;font-weight:900;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .tag{color:#4a5568}
    .content{background:#fff;border-radius:16px;padding:18px;margin:18px 0;box-shadow:0 14px 36px rgba(0,0,0,.12)}
    .filters{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .card{background:#fff;border-radius:12px;border:2px solid transparent;padding:16px;box-shadow:0 8px 26px rgba(0,0,0,.08)}
    .card:hover{border-color:#667eea}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(360px,1fr));gap:16px}
    .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .badge{background:#edf2f7;color:#4a5568;padding:4px 8px;border-radius:999px;font-size:.8rem;font-weight:700}
    .primary{background:linear-gradient(135deg,#fed7d7,#feb2b2);color:#742a2a}
    .top{display:flex;justify-content:space-between;align-items:flex-start}
    .id{background:#667eea;color:#fff;padding:4px 10px;border-radius:10px;font-size:.75rem;font-weight:800}
    .ratings{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;background:linear-gradient(135deg,#f7fafc,#edf2f7);border-radius:12px;padding:10px;margin:8px 0}
    .rlabel{font-size:.7rem;color:#718096;text-transform:uppercase;font-weight:800}
    .rval{font-weight:900}
    .btn{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:0;border-radius:20px;padding:8px 14px;font-weight:800;cursor:pointer}
    .salary{color:#48bb78;font-weight:900}
    @media(max-width:768px){.grid{grid-template-columns:1fr}.ratings{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
  <div class="header">
    <div class="container">
      <div class="logo">justüîó4u</div>
      <div class="tag">Find and contact verified developers fast</div>
    </div>
  </div>

  <div class="container">
    <div class="content">
      <h2>Filters</h2>
      <div class="filters">
        <div>
          <label>Budget min</label>
          <input id="minSalary" type="number" value="1000" style="width:100%" />
        </div>
        <div>
          <label>Budget max</label>
          <input id="maxSalary" type="number" value="8000" style="width:100%" />
        </div>
        <div>
          <label>Min experience</label>
          <input id="minExp" type="number" value="0" style="width:100%" />
        </div>
        <div>
          <label>Max experience</label>
          <input id="maxExp" type="number" value="15" style="width:100%" />
        </div>
        <div>
          <label>Min Tech Score</label>
          <input id="minTechScore" type="number" value="0" style="width:100%" />
        </div>
        <div>
          <label>Category</label>
          <select id="category" multiple style="width:100%"></select>
        </div>
        <div>
          <label>Technology</label>
          <select id="tech" multiple style="width:100%"></select>
        </div>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px;align-items:center;">
        <button class="btn" onclick="applyFilters()">Apply</button>
        <span id="count"></span>
      </div>
    </div>

    <div class="content">
      <h2>Developers</h2>
      <div id="grid" class="grid"></div>
    </div>
  </div>

  <script>
    let allDevs = [];
    let filtered = [];

    function opt(v){ const o=document.createElement('option'); o.value=v; o.textContent=v; return o; }

    async function loadDevs(){
      const params = new URLSearchParams();
      const res = await fetch('/api/developers?'+params.toString());
      const data = await res.json();
      allDevs = data.developers || [];
      const cats = [...new Set(allDevs.map(d=>d.category))].sort();
      const techs = [...new Set(allDevs.flatMap(d=>d.technologies))].sort();
      const catSel = document.getElementById('category');
      const techSel = document.getElementById('tech');
      cats.forEach(c=>catSel.appendChild(opt(c)));
      techs.forEach(t=>techSel.appendChild(opt(t)));
      filtered = allDevs;
      render();
    }

    function getSelected(sel){ return Array.from(sel.selectedOptions).map(o=>o.value); }

    async function applyFilters(){
      const minSalary = document.getElementById('minSalary').value || 0;
      const maxSalary = document.getElementById('maxSalary').value || 999999;
      const minExp = document.getElementById('minExp').value || 0;
      const maxExp = document.getElementById('maxExp').value || 99;
      const minTechScore = document.getElementById('minTechScore').value || 0;
      const cats = getSelected(document.getElementById('category'));
      const techs = getSelected(document.getElementById('tech'));
      const q = new URLSearchParams();
      if (cats.length) q.set('category', cats.join(','));
      if (techs.length) q.set('tech', techs.join(','));
      if (minSalary) q.set('minSalary', minSalary);
      if (maxSalary) q.set('maxSalary', maxSalary);
      if (minExp) q.set('minExp', minExp);
      if (maxExp) q.set('maxExp', maxExp);
      if (minTechScore) q.set('minTechScore', minTechScore);
      const res = await fetch('/api/developers?'+q.toString());
      const data = await res.json();
      filtered = data.developers || [];
      render();
    }

    function badge(text, cls=''){ return `<span class="badge ${cls}">${text}</span>`; }

    function card(dev){
      return `<div class="card">
        <div class="top">
          <div style="font-weight:800">${dev.position}</div>
          <div class="id">#${dev.developerId}</div>
        </div>
        <div class="row" style="margin:8px 0">${badge('üìÖ '+dev.experienceYears+' yrs')}${badge('üåç '+dev.englishLevel)}${badge('üìä '+dev.projectsCount+' projects')}${badge('üü¢ '+dev.availability)}</div>
        <div class="ratings">
          <div><div class="rlabel">Tech Score</div><div class="rval" style="color:#667eea">${dev.techScore}</div></div>
          <div><div class="rlabel">Rating</div><div class="rval" style="color:#48bb78">${dev.rating}‚òÖ</div></div>
          <div><div class="rlabel">Category</div><div class="rval" style="color:#ed8936">${dev.category}</div></div>
          <div><div class="rlabel">Video</div><div class="rval">${dev.video || 'Soon'}</div></div>
        </div>
        <div class="row">${dev.technologies.slice(0,6).map((t,i)=>badge(t,i<2?'primary':'' )).join('')}</div>
        ${dev.projectSectors?.length?`<div class="row" style="margin:6px 0">${dev.projectSectors.map(s=>badge(s)).join('')}</div>`:''}
        ${dev.achievements?.length?`<div style="color:#4a5568;margin:6px 0">${dev.achievements.map(a=>'‚Ä¢ '+a).join('<br/>')}</div>`:''}
        <div class="row" style="justify-content:space-between;border-top:1px solid #e2e8f0;padding-top:8px;margin-top:8px">
          <div class="salary">$${dev.salaryUSD.toLocaleString()} / mo</div>
          <button class="btn" onclick="contact('${dev.developerId}')">üíé Contact</button>
        </div>
      </div>`
    }

    function render(){
      document.getElementById('count').textContent = `Found ${filtered.length}`;
      document.getElementById('grid').innerHTML = filtered.map(card).join('');
    }

    async function contact(developerId){
      const name = prompt('Your Name:'); if(!name) return;
      const email = prompt('Your Email:'); if(!email) return;
      const projectDescription = prompt('Project Description (optional):') || '';
      const res = await fetch('/api/contact',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name,email,developerId,projectDescription})});
      const data = await res.json();
      if (data.ok) alert('Request sent!'); else alert('Error: '+(data.error||'unknown'));
    }

    loadDevs();
  </script>
</body>
</html>